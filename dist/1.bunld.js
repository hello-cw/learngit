webpackJsonp([1],{265:function(t,e,n){"use strict";function l(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var l=e[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(e,n,l){return n&&t(e.prototype,n),l&&t(e,l),e}}(),u=n(0),r=l(u),c=n(13),h=(l(c),n(321)),p=l(h),d=n(128),f=l(d),S=function(t){function e(t){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={items:[],pullDownStatus:3,pullUpStatus:0},n.page=1,n.itemsChanged=!1,n.pullDownTips={0:"下拉发起刷新",1:"继续下拉刷新",2:"松手即可刷新",3:"正在刷新",4:"刷新成功"},n.pullUpTips={0:"上拉发起加载",1:"松手即可加载",2:"正在加载",3:"加载成功"},n.isTouching=!1,n.onItemClicked=n.onItemClicked.bind(n),n.onScroll=n.onScroll.bind(n),n.onScrollEnd=n.onScrollEnd.bind(n),n.onTouchStart=n.onTouchStart.bind(n),n.onTouchEnd=n.onTouchEnd.bind(n),n}return s(e,t),a(e,[{key:"componentDidMount",value:function(){var t={preventDefault:!1,zoom:!1,mouseWheel:!0,probeType:3,bounce:!0,scrollbars:!0};this.iScrollInstance=new f.default("#"+p.default.ListOutsite,t),this.iScrollInstance.on("scroll",this.onScroll),this.iScrollInstance.on("scrollEnd",this.onScrollEnd),this.fetchItems(!0)}},{key:"fetchItems",value:function(t){var e=this;t&&(this.page=1),$.ajax({url:"/msg-list",data:{page:this.page},type:"GET",dataType:"json",success:function(n){t?3==e.state.pullDownStatus&&(e.setState({pullDownStatus:4,items:n.data.items}),e.iScrollInstance.scrollTo(0,-1*$(e.refs.PullDown).height(),500)):2==e.state.pullUpStatus&&e.setState({pullUpStatus:0,items:e.state.items.concat(n.data.items)}),++e.page,console.log("fetchItems=effected isRefresh="+t)}})}},{key:"onTouchStart",value:function(t){this.isTouching=!0}},{key:"onTouchEnd",value:function(t){this.isTouching=!1}},{key:"onPullDown",value:function(){this.isTouching&&(this.iScrollInstance.y>5?2!=this.state.pullDownStatus&&this.setState({pullDownStatus:2}):1!=this.state.pullDownStatus&&this.setState({pullDownStatus:1}))}},{key:"onPullUp",value:function(){this.isTouching&&(this.iScrollInstance.y<=this.iScrollInstance.maxScrollY-5?1!=this.state.pullUpStatus&&this.setState({pullUpStatus:1}):0!=this.state.pullUpStatus&&this.setState({pullUpStatus:0}))}},{key:"onScroll",value:function(){var t=$(this.refs.PullDown);this.iScrollInstance.y>-1*t.height()?this.onPullDown():0!=this.state.pullDownStatus&&this.setState({pullDownStatus:0}),this.iScrollInstance.y<=this.iScrollInstance.maxScrollY+5&&this.onPullUp()}},{key:"onScrollEnd",value:function(){console.log("onScrollEnd"+this.state.pullDownStatus);var t=$(this.refs.PullDown);this.iScrollInstance.y>-1*t.height()&&(this.state.pullDownStatus<=1?this.iScrollInstance.scrollTo(0,-1*$(this.refs.PullDown).height(),200):2==this.state.pullDownStatus&&(this.setState({pullDownStatus:3}),this.fetchItems(!0))),this.iScrollInstance.y<=this.iScrollInstance.maxScrollY&&1==this.state.pullUpStatus&&(this.setState({pullUpStatus:2}),this.fetchItems(!1))}},{key:"shouldComponentUpdate",value:function(t,e){return this.itemsChanged=e.items!==this.state.items,!0}},{key:"componentDidUpdate",value:function(){return this.itemsChanged&&this.iScrollInstance.refresh(),!0}},{key:"render",value:function(){var t=this,e=[];return this.state.items.forEach(function(n,l){e.push(r.default.createElement("li",{key:l,to:"/msg-detail-page/"+l,onClick:t.onItemClicked},n.title,l))}),r.default.createElement("div",{id:p.default.ScrollContainer},r.default.createElement("div",{id:p.default.ListOutsite,style:{height:window.innerHeight},onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},r.default.createElement("ul",{id:p.default.ListInside},r.default.createElement("p",{ref:"PullDown",id:p.default.PullDown},this.pullDownTips[this.state.pullDownStatus]),e,r.default.createElement("p",{ref:"PullUp",id:p.default.PullUp},this.pullUpTips[this.state.pullUpStatus]))))}}]),e}(u.Component);e.default=S},320:function(t,e,n){e=t.exports=n(9)(),e.push([t.i,"#PullDown {\n  margin: 0px;\n  height: 40px;\n  width: 100%;\n  text-align: center;\n  font-size: 15px;\n  background-color: white;\n  line-height: 40px; }\n\n#PullUp {\n  margin: 0px;\n  height: 40px;\n  width: 100%;\n  text-align: center;\n  font-size: 15px;\n  background-color: white;\n  line-height: 40px; }\n\n#ListOutsite {\n  position: relative; }\n\n#ListInside {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  min-height: 150%; }\n\n#ListInside li {\n  height: 80px;\n  padding: 0 10%;\n  width: 80%;\n  vertical-align: middle;\n  line-height: 80px;\n  font-size: 18px;\n  border: 1px solid lightsteelblue;\n  overflow: hidden;\n  background-color: blanchedalmond; }\n",""])},321:function(t,e,n){var l=n(320);"string"==typeof l&&(l=[[t.i,l,""]]);n(10)(l,{});l.locals&&(t.exports=l.locals)}});